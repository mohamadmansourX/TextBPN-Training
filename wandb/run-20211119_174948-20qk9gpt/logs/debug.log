2021-11-19 17:49:48,154 INFO    MainThread:84470 [wandb_setup.py:_flush():69] setting env: {}
2021-11-19 17:49:48,154 INFO    MainThread:84470 [wandb_setup.py:_flush():69] setting login settings: {}
2021-11-19 17:49:48,154 INFO    MainThread:84470 [wandb_init.py:_log_setup():336] Logging user logs to /home/mansour/Music/OtherWork/TextBPN/wandb/run-20211119_174948-20qk9gpt/logs/debug.log
2021-11-19 17:49:48,154 INFO    MainThread:84470 [wandb_init.py:_log_setup():337] Logging internal logs to /home/mansour/Music/OtherWork/TextBPN/wandb/run-20211119_174948-20qk9gpt/logs/debug-internal.log
2021-11-19 17:49:48,154 INFO    MainThread:84470 [wandb_init.py:init():369] calling init triggers
2021-11-19 17:49:48,155 INFO    MainThread:84470 [wandb_init.py:init():376] wandb.init called with sweep_config: {}
config: {'gpu': [0], 'cuda': False, 'num_workers': 1, 'batch_size': 12, 'max_epoch': 200, 'start_epoch': 0, 'lr': 0.001, 'output_dir': 'output', 'input_size': 640, 'max_annotation': 64, 'num_points': 20, 'adj_num': 4, 'max_points': 20, 'use_hard': True, 'scale': 1, 'grad_clip': 0, 'dis_threshold': 0.3, 'cls_threshold': 0.875, 'approx_factor': 0.007, 'use_gpu': False, 'print_freq': 2, 'val_freq': 1, 'save_freq': 5, 'checkepoch': 590, 'save_path': './checkpoints/', 'pretrain': './model/TD500/TextBPN_resnet50_680.pth', 'pretrain_model': './model/TD500/TextBPN_resnet50_680.pth', 'dataset': 'TD500', 'vis_dir': 'vis_dir', 'log_dir': 'log_dir', 'output_idr': 'output', 'epochs': 200, 'device': device(type='cpu'), 'global_use_gpu': False, 'global_gpu': [0], 'global_print_freq': 2, 'global_val_freq': 1, 'global_save_freq': 10, 'global_checkepoch': -1, 'global_save_path': './checkpoints/', 'global_pretrain': True, 'global_pretrain_model': './model/TD500/TextBPN_resnet50_680.pth', 'global_dataset': 'TD500', 'global_vis_dir': 'vis_dir', 'global_log_dir': 'log_dir', 'global_output_idr': 'output', 'global_epochs': 200, 'train_data_root': 'data/TD500', 'train_input_size': 512, 'train_max_annotation': 64, 'train_num_points': 20, 'train_adj_num': 4, 'train_max_points': 20, 'train_use_hard': True, 'train_scale': 1, 'train_grad_clip': 0, 'train_dis_threshold': 0.3, 'train_cls_threshold': 0.8, 'train_approx_factor': 0.007, 'train_rgb_mean': [0.485, 0.456, 0.406], 'train_rgb_std': [0.229, 0.224, 0.225], 'train_step_size': 20, 'train_lr': 0.0001, 'train_gamma': 0.1, 'train_shuffle': True, 'train_num_workers': 0, 'train_batch_size': 12, 'val_data_root': 'data/TD500', 'val_input_size': 512, 'val_rgb_mean': [0.485, 0.456, 0.406], 'val_rgb_std': [0.229, 0.224, 0.225], 'val_shuffle': False, 'val_num_workers': 1, 'val_batch_size': 1, 'wandb_flag': True, 'wandb_project': 'TextBPN', 'wandb_name': './TD500', 'exp_name': 'Totaltext', 'mgpu': False, 'save_dir': 'checkpoints', 'loss': 'CrossEntropyLoss', 'viz': False, 'lr_adjust': 'fix', 'stepvalues': [], 'weight_decay': 0.0, 'gamma': 0.1, 'momentum': 0.9, 'optim': 'Adam', 'display_freq': 10, 'viz_freq': 50, 'log_freq': 10000, 'net': 'resnet50', 'rescale': 255.0, 'means': [0.485, 0.456, 0.406], 'stds': [0.229, 0.224, 0.225], 'test_size': [640, 1024]}
2021-11-19 17:49:48,155 INFO    MainThread:84470 [wandb_init.py:init():418] starting backend
2021-11-19 17:49:48,155 INFO    MainThread:84470 [backend.py:_multiprocessing_setup():71] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2021-11-19 17:49:48,167 INFO    MainThread:84470 [backend.py:ensure_launched():123] starting backend process...
2021-11-19 17:49:48,173 INFO    MainThread:84470 [backend.py:ensure_launched():128] started backend process with pid: 84563
2021-11-19 17:49:48,174 INFO    MainThread:84470 [wandb_init.py:init():423] backend started and connected
2021-11-19 17:49:48,176 INFO    MainThread:84470 [wandb_init.py:init():465] updated telemetry
2021-11-19 17:49:48,177 INFO    MainThread:84470 [wandb_init.py:init():484] communicating current version
2021-11-19 17:49:53,177 INFO    MainThread:84470 [wandb_init.py:init():497] communicating run to backend with 30 second timeout
2021-11-19 17:50:16,510 ERROR   Thread-1  :84470 [retry.py:__call__():111] Retry attempt failed:
Traceback (most recent call last):
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/site-packages/urllib3/connection.py", line 170, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/site-packages/urllib3/util/connection.py", line 96, in create_connection
    raise err
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/site-packages/urllib3/util/connection.py", line 86, in create_connection
    sock.connect(sa)
socket.timeout: timed out

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/site-packages/urllib3/connectionpool.py", line 382, in _make_request
    self._validate_conn(conn)
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/site-packages/urllib3/connectionpool.py", line 1010, in _validate_conn
    conn.connect()
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/site-packages/urllib3/connection.py", line 353, in connect
    conn = self._new_conn()
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/site-packages/urllib3/connection.py", line 177, in _new_conn
    % (self.host, self.timeout),
urllib3.exceptions.ConnectTimeoutError: (<urllib3.connection.HTTPSConnection object at 0x7fb15df66780>, 'Connection to api.wandb.ai timed out. (connect timeout=10)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/site-packages/urllib3/connectionpool.py", line 756, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/site-packages/urllib3/util/retry.py", line 573, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.wandb.ai', port=443): Max retries exceeded with url: /graphql (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x7fb15df66780>, 'Connection to api.wandb.ai timed out. (connect timeout=10)'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/site-packages/wandb/old/retry.py", line 96, in __call__
    result = self._call_fn(*args, **kwargs)
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/site-packages/wandb/sdk/internal/internal_api.py", line 124, in execute
    return self.client.execute(*args, **kwargs)
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/site-packages/wandb/vendor/gql-0.2.0/gql/client.py", line 52, in execute
    result = self._get_result(document, *args, **kwargs)
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/site-packages/wandb/vendor/gql-0.2.0/gql/client.py", line 60, in _get_result
    return self.transport.execute(document, *args, **kwargs)
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/site-packages/wandb/vendor/gql-0.2.0/gql/transport/requests.py", line 38, in execute
    request = requests.post(self.url, **post_args)
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/site-packages/requests/api.py", line 119, in post
    return request('post', url, data=data, json=json, **kwargs)
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/site-packages/requests/adapters.py", line 504, in send
    raise ConnectTimeout(e, request=request)
requests.exceptions.ConnectTimeout: HTTPSConnectionPool(host='api.wandb.ai', port=443): Max retries exceeded with url: /graphql (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x7fb15df66780>, 'Connection to api.wandb.ai timed out. (connect timeout=10)'))
2021-11-19 17:50:23,179 INFO    MainThread:84470 [interface.py:_communicate_run():642] couldn't get run from backend
2021-11-19 17:50:23,179 ERROR   MainThread:84470 [wandb_init.py:init():501] backend process timed out
2021-11-19 17:50:23,180 ERROR   MainThread:84470 [wandb_init.py:init():510] encountered error: Error communicating with wandb process
try: wandb.init(settings=wandb.Settings(start_method='fork'))
or:  wandb.init(settings=wandb.Settings(start_method='thread'))
For more info see: https://docs.wandb.ai/library/init#init-start-error
2021-11-19 17:51:28,305 WARNING MainThread:84470 [wandb_init.py:init():764] interrupted
Traceback (most recent call last):
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/site-packages/wandb/sdk/wandb_init.py", line 744, in init
    run = wi.init()
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/site-packages/wandb/sdk/wandb_init.py", line 513, in init
    backend.cleanup()
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/site-packages/wandb/sdk/backend/backend.py", line 155, in cleanup
    self.wandb_process.join()
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/multiprocessing/process.py", line 140, in join
    res = self._popen.wait(timeout)
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/multiprocessing/popen_fork.py", line 48, in wait
    return self.poll(os.WNOHANG if timeout == 0.0 else 0)
  File "/home/mansour/anaconda3/envs/v2/lib/python3.7/multiprocessing/popen_fork.py", line 28, in poll
    pid, sts = os.waitpid(self.pid, flag)
KeyboardInterrupt
